<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>JOSN WEB TOKEN | wolfjyx&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="定义JSON Web Token（JWT)是一种开放标准 RFC7519。它定义了一种紧凑的、自包含的方式，将信息作为JSON对象在各方之间安全地传输。由于使用了数字签名，该信息是可以验证和信任的。JWT可以使用密码（使用HMAC算法）或使用RSA或ECDSA的公钥/私钥对进行签名。总之，JSON Web Token（JWT）是一个非常轻巧的规范。这个规范允许我们使用JWT在用户和服务器之间传递安">
<meta property="og:type" content="article">
<meta property="og:title" content="JOSN WEB TOKEN">
<meta property="og:url" content="http://wolfjyx.github.com/2019/01/27/Json web token/index.html">
<meta property="og:site_name" content="wolfjyx&#39;s blog">
<meta property="og:description" content="定义JSON Web Token（JWT)是一种开放标准 RFC7519。它定义了一种紧凑的、自包含的方式，将信息作为JSON对象在各方之间安全地传输。由于使用了数字签名，该信息是可以验证和信任的。JWT可以使用密码（使用HMAC算法）或使用RSA或ECDSA的公钥/私钥对进行签名。总之，JSON Web Token（JWT）是一个非常轻巧的规范。这个规范允许我们使用JWT在用户和服务器之间传递安">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-01-27T12:31:04.395Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JOSN WEB TOKEN">
<meta name="twitter:description" content="定义JSON Web Token（JWT)是一种开放标准 RFC7519。它定义了一种紧凑的、自包含的方式，将信息作为JSON对象在各方之间安全地传输。由于使用了数字签名，该信息是可以验证和信任的。JWT可以使用密码（使用HMAC算法）或使用RSA或ECDSA的公钥/私钥对进行签名。总之，JSON Web Token（JWT）是一个非常轻巧的规范。这个规范允许我们使用JWT在用户和服务器之间传递安">
  
    <link rel="alternate" href="/atom.xml" title="wolfjyx&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">wolfjyx&#39;s blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">博客的博，博客的客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://wolfjyx.github.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Json web token" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/27/Json web token/" class="article-date">
  <time datetime="2019-01-27T12:31:04.394Z" itemprop="datePublished">2019-01-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JOSN WEB TOKEN
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><a href="jwt.io Debugger">JSON Web Token（JWT)</a>是一种开放标准 <a href="https://tools.ietf.org/html/rfc7519" target="_blank" rel="noopener">RFC7519</a>。<br>它定义了一种紧凑的、自包含的方式，将信息作为JSON对象在各方之间安全地传输。<br>由于使用了数字签名，该信息是可以验证和信任的。<br>JWT可以使用密码（使用HMAC算法）或使用RSA或ECDSA的公钥/私钥对进行签名。<br>总之，JSON Web Token（JWT）是一个非常轻巧的规范。这个规范允许我们使用JWT在用户和服务器之间传递安全可靠的信息。</p>
<h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><p>在其紧凑的形式中，JWT 由三个部分组成，由点（.）分隔，分别是：</p>
<ul>
<li>Header 头部</li>
<li>Payload 载荷</li>
<li>Signature 签名</li>
</ul>
<p>因此，JWT通常如下所示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxxxx.yyyyy.zzzzz</span><br></pre></td></tr></table></figure>
<h3 id="头部-header"><a href="#头部-header" class="headerlink" title="头部 (header)"></a>头部 (header)</h3><p>头通常由两部分组成：令牌的类型（JWT）和正在使用的签名算法（如HMAC SHA256或RSA）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将JSON转为base64url编码，以形成JWT的第一部分</p>
<h3 id="载荷（payload"><a href="#载荷（payload" class="headerlink" title="载荷（payload)"></a>载荷（payload)</h3><p>载荷包含声明。声明是关于实体（通常是用户）和附加数据的语句。<br>声明有三种类型：注册声明、公开声明和私有声明</p>
<p><strong>注册声明</strong><br>这是一组预定义的声明，这些声明是建议但不必需的<br>该声明提供一组有用的、可交换操作的声明</p>
<ul>
<li>iss:(Issuer)  该JWT的签发者  </li>
<li>sub:(Subject) 该JWT所面向的用户  </li>
<li>aud: (Audience)接收该JWT的一方  </li>
<li>exp(expires): 什么时候过期，这里是一个Unix时间戳  </li>
<li>nbf (Not Before) 该JWT到什么时间有效  </li>
<li>iat(issued at): 在什么时候签发的  </li>
<li>jti(JWT ID)：该JWT唯一标识  </li>
</ul>
<p><strong>公开声明</strong><br>这些可以由使用JWT的人员随意定义。但是为了避免冲突，应该是在 <a href="https://www.iana.org/assignments/jwt/jwt.xhtml" target="_blank" rel="noopener">IANA JSON Web Token Registry</a>中定义的<br>或者将它们定义为包含防冲突命名空间的URI。</p>
<p><strong>私有声明</strong><br>自定义声明，用来在各方间共享信息，区别于注册声明和公开声明 </p>
<p>这是载荷的一个实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class="line">  &quot;admin&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将JSON转为base64url编码，以形成JWT的第二部分</p>
<h3 id="签名-Signature"><a href="#签名-Signature" class="headerlink" title="签名 (Signature)"></a>签名 (Signature)</h3><p>签名部分，包含 编码过的头部、编码过的载荷、密码、头部中指定的算法，并对这些此进行签名计算。</p>
<p>例如，如果要使用hmac sha256算法，将按以下方式创建签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + &quot;.&quot; +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  secret)</span><br></pre></td></tr></table></figure>
<p>签名用于验证消息是否在过程中发生了更改，对于使用私钥签名的令牌，它还可以验证JWT的发送者是它所说的人。</p>
<h2 id="jWT如何工作"><a href="#jWT如何工作" class="headerlink" title="jWT如何工作"></a>jWT如何工作</h2><p>在身份验证中，当用户使用其凭据成功登录时，将返回JWT。因为令牌是凭证，所以必须非常小心地防止安全问题。一般来说，您不应该将令牌保留超过所需的时间。</p>
<p>每当用户想要访问受保护的路由或资源时，用户代理应该使用承载模式发送JWT，通常是在授权头中。标题的内容应如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: Bearer &lt;token&gt;</span><br></pre></td></tr></table></figure>
<p>在某些情况下，这可以是无状态授权机制。服务器的受保护路由将检查授权头中是否存在有效的JWT，如果存在，则允许用户访问受保护的资源。如果JWT包含必要的数据，那么查询数据库进行某些操作的需求可能会减少，尽管情况并非总是如此。</p>
<p>如果token设置在Authorization，Cross-Origin Resource Sharing (CORS) 将不再是问题，因为这不适用cookie</p>
<p>如何获取和使用JWT来访问API或资源：</p>
<ol>
<li>应用程序或客户端向授权服务器请求授权。这是通过一个不同的授权流执行的。例如，典型的<a href="https://openid.net/connect/" target="_blank" rel="noopener"> OpenID Connect</a>兼容Web应用程序将使用<a href="https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth" target="_blank" rel="noopener">authorization code flow</a>通过 /oauth/authorize端点。  </li>
<li>授予授权后，授权服务器将向应用程序返回访问令牌。  </li>
<li>应用程序使用访问令牌访问受保护的资源（如API）。 </li>
</ol>
<p>ps: 对于签名的令牌，令牌中包含的所有信息都将向用户或其他方公开，即无法更改它。这意味着不应该将秘密信息放在令牌中。</p>
<h2 id="jwt优势"><a href="#jwt优势" class="headerlink" title="jwt优势"></a>jwt优势</h2><ol>
<li>传输数据量小</li>
<li>安全方面，SWT只能使用HMAC算法由共享机密对称签名。但是，JWT和SAML令牌可以使用X.509证书形式的公钥/私钥对进行签名。与简单的JSON签名相比，用XML数字签名来签名XML而不引入模糊的安全漏洞是非常困难的。 </li>
<li>JSON解析器在大多数编程语言中很常见，因为它们直接映射到对象。相反，XML没有一个自然的文档到对象的映射。这使得使用JWT比使用SAML断言更容易。</li>
</ol>
<h2 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h2><ul>
<li>用于向Web应用传递一些非敏感信息。例如完成加好友、下订单的操作等等。</li>
<li>用于设计用户认证和授权系统。</li>
<li>实现Web应用的单点登录。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wolfjyx.github.com/2019/01/27/Json web token/" data-id="cjrevv3nr0000dvjipvoql51v" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/01/20/linux  命令/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/">electron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flex/">flex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/freemark-模板/">freemark 模板</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grid/">grid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/head/">head</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js-threejs/">js threejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webstrom-IDE/">webstrom IDE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器/">浏览器</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/electron/" style="font-size: 10px;">electron</a> <a href="/tags/flex/" style="font-size: 10px;">flex</a> <a href="/tags/freemark-模板/" style="font-size: 10px;">freemark 模板</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/grid/" style="font-size: 10px;">grid</a> <a href="/tags/head/" style="font-size: 10px;">head</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/js-threejs/" style="font-size: 20px;">js threejs</a> <a href="/tags/webstrom-IDE/" style="font-size: 10px;">webstrom IDE</a> <a href="/tags/浏览器/" style="font-size: 15px;">浏览器</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/01/27/Json web token/">JOSN WEB TOKEN</a>
          </li>
        
          <li>
            <a href="/2019/01/20/linux  命令/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/01/20/vim 手册/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/01/13/git简介/">git 简介</a>
          </li>
        
          <li>
            <a href="/2019/01/03/electron 调用 dll 文件/">electron 调用 dll 文件</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 wolfjyx<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>